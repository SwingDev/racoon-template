const Promise = require('bluebird');

const jwt = require('jsonwebtoken');
Promise.promisifyAll(jwt);


function encrypt(data, secret, bits=256) {
  const algorithm = `HS${bits}`;

  return jwt.signAsync(data, secret, { algorithm });
}

function decrypt(token) {
  return Promise.resolve(token).then(jwt.decode);
}


module.exports = { encrypt, decrypt };
